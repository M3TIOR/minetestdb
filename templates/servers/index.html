{%  extends "minetestdb/base.html" %}

{% block title %}MTCD Servers{% endblock %}

{%  block content %}
    <div class="container">
        <div class="row">
            <div class="col-sm-3">
                <a href="{% url 'servers:new' %}">
                    <button type="button" class="btn btn-default">Create a new server posting</button>
                </a><br><br>
                <form action="." method="post">
            {% csrf_token %}
                    {% comment %}<div class="form-group">
                        <div class="panel panel-default">
                            <div class="panel-heading">Sort By:</div>
                            <div class="panel-body">
                                <div class="dropdown">
                                    <select class="form-control" id="sort" name="sort">
                                        <option>Oldest</option>
                                        <option>Newest</option>
                                        <option>Most Stars</option>
                                        <option>????</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>{% endcomment %}
                    <div class="form-group">
                        <div class="panel panel-default">
                            <div class="panel-heading">Minetest Version </div>
                            <div class="panel-body">
                                {% for server in servers %}
	                                    <div class="checkbox">
	                                        <label><input type="checkbox"
	                                                name="{{ server.id }}"
													{% comment %}
														Here, I had to filter the value of server.id
														because it's natively an interger.
														The django template interpreter doesn't do any
														type checking so we have to have both values we're
														comparing be the same type, otherwise they won't
														be properly compaired and our code misbehave.
													{% endcomment %}
													{% if server.id|stringformat:"i" in post.keys%}
	                                                    checked
	                                                {% endif %}
	                                        >{{ server.mt_version }}</label>
	                                    </div>
								{% endfor %}
                            </div>
                        </div>
                    </div>

                    <input type="submit" class="btn btn-default" value="Apply Filters">
                </form>
            </div>
            <div class="col-sm-9">
                {% if current_server_list %}
                    {% for server in current_server_list %}

                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <a href="{% url 'servers:detail' server.name %}">{{ server.name }}</a>
                                <span class="pull-right">{{ server.address }}</span>
                            </div>
                            <div class="panel-body">
                                <p>{{ server.description|truncatechars:250 }}</p>
                                    {%  for tag in server.tags.all %}
                                        <span class="label label-default">{{ tag }}</span>
                                    {% endfor %}

                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <p>No servers are available.</p>
                {% endif %}
{% comment %}                {% for i, k in post.items %}
                    {{ i }} and {{ k }} <br>
                {%  endfor %}{% endcomment %}
            </div>
        </div>
    </div>
{% endblock %}
